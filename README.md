# RealTraj

RealTraj contains Python utilities for predicting future trajectories and activities of people in videos.
The project links together object detection, multi-object tracking, scene segmentation and a prediction model to produce trajectory forecasts.

## Folder structure

```
code/               Main source files
  inference/        Scripts for running inference on videos
    Object_Detection_Tracking/  Forked utilities for detection and tracking
  pred_models.py    TensorFlow prediction model
  pred_utils.py     Helper utilities and argument processing
```

## Requirements

This repository relies on Python 3 with TensorFlow 1.x style APIs and a few common packages.
Install the basics via pip:

```
pip install tensorflow opencv-python numpy matplotlib tqdm pycocotools scipy
```

## Running inference

1. Prepare a text file where each line is the absolute path to a video.
2. Download the pretrained models referenced in `code/inference/main.py` and update the command line arguments if they are stored in a different location.
3. Execute the prediction script:

```
python code/inference/main.py video_list.txt output_dir
```

The script will create subâ€‘folders under `output_dir` for frames, object detections, tracks, scene segmentation results and predicted trajectories. Optional visualisations can be generated by passing `--pred_vis_path`.

## Notes

The repository is provided as-is with minimal documentation. Several model files referenced by the scripts are not included and must be supplied separately.
